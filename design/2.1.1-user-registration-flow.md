# 2.1.1 User Registration Flow

## Feature: User Registration
**Actor:** Public (Anyone)  
**Dependencies:** None

## Flowchart

```mermaid
flowchart TD
    Start([User visits registration page]) --> ClickRegister[Click 'Đăng ký' button]
    ClickRegister --> ShowForm[Display registration form]
    ShowForm --> FillForm[User fills form:<br/>- Email<br/>- Name<br/>- Password<br/>- Confirm Password]
    FillForm --> Validate{Validate input}
    
    Validate -->|Invalid Email Format| ErrorEmail[Show error: Invalid email format]
    ErrorEmail --> FillForm
    
    Validate -->|Name Empty or > 50 chars| ErrorName[Show error: Name validation failed]
    ErrorName --> FillForm
    
    Validate -->|Password < 8 or > 16 chars| ErrorPassword[Show error: Password validation failed]
    ErrorPassword --> FillForm
    
    Validate -->|Passwords don't match| ErrorMatch[Show error: Passwords don't match]
    ErrorMatch --> FillForm
    
    Validate -->|Email already exists| ErrorExists[Show error: Email already exists]
    ErrorExists --> FillForm
    
    Validate -->|All valid| SubmitForm[Submit form]
    SubmitForm --> CheckEmail{Email exists?}
    
    CheckEmail -->|Yes| ErrorExists
    CheckEmail -->|No| CreateAccount[Create account with status 'Chờ xác nhận']
    CreateAccount --> SaveDB{Save to database}
    
    SaveDB -->|Success| ShowSuccess[Show success message]
    SaveDB -->|Network Error| ErrorNetwork[Show network error, allow retry]
    ErrorNetwork --> SubmitForm
    
    ShowSuccess --> End([Registration complete])
    
    FillForm --> Cancel[User cancels]
    Cancel --> HomePage([Return to home page])
    
    style Start fill:#e1f5ff
    style End fill:#c8e6c9
    style HomePage fill:#fff9c4
    style ErrorEmail fill:#ffcdd2
    style ErrorName fill:#ffcdd2
    style ErrorPassword fill:#ffcdd2
    style ErrorMatch fill:#ffcdd2
    style ErrorExists fill:#ffcdd2
    style ErrorNetwork fill:#ffcdd2
    style ShowSuccess fill:#c8e6c9
```

## Validation Rules
- **Email:** Valid email format
- **Name:** Not empty, max 50 characters
- **Password:** Not empty, min 8, max 16 characters
- **Confirm Password:** Must match password

## Error Cases
- Email already exists
- Invalid email format
- Name validation failed
- Password validation failed
- Passwords don't match
- Network error during submission

